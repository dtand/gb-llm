// Simon - Sprite and Tile Data

#include <gb/gb.h>
#include "sprites.h"

// ===========================================
// BUTTON TILES (for the 4 quadrants)
// ===========================================

const unsigned char button_tiles[] = {
    // TILE 0: Empty
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    
    // TILE 1: Button top-left (dark)
    0x3F, 0x3F, 0x7F, 0x40, 0xFF, 0x80, 0xFF, 0x80,
    0xFF, 0x80, 0xFF, 0x80, 0xFF, 0x80, 0xFF, 0x80,
    
    // TILE 2: Button top-right (dark)
    0xFC, 0xFC, 0xFE, 0x02, 0xFF, 0x01, 0xFF, 0x01,
    0xFF, 0x01, 0xFF, 0x01, 0xFF, 0x01, 0xFF, 0x01,
    
    // TILE 3: Button bottom-left (dark)
    0xFF, 0x80, 0xFF, 0x80, 0xFF, 0x80, 0xFF, 0x80,
    0xFF, 0x80, 0xFF, 0x80, 0x7F, 0x40, 0x3F, 0x3F,
    
    // TILE 4: Button bottom-right (dark)
    0xFF, 0x01, 0xFF, 0x01, 0xFF, 0x01, 0xFF, 0x01,
    0xFF, 0x01, 0xFF, 0x01, 0xFE, 0x02, 0xFC, 0xFC,
    
    // TILE 5: Button top-left (lit/bright)
    0x3F, 0x00, 0x7F, 0x00, 0xFF, 0x00, 0xFF, 0x00,
    0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00,
    
    // TILE 6: Button top-right (lit/bright)
    0xFC, 0x00, 0xFE, 0x00, 0xFF, 0x00, 0xFF, 0x00,
    0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00,
    
    // TILE 7: Button bottom-left (lit/bright)
    0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00,
    0xFF, 0x00, 0xFF, 0x00, 0x7F, 0x00, 0x3F, 0x00,
    
    // TILE 8: Button bottom-right (lit/bright)
    0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00,
    0xFF, 0x00, 0xFF, 0x00, 0xFE, 0x00, 0xFC, 0x00,
    
    // TILE 9: Center piece
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18,
    0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const unsigned char hud_tiles[] = {
    // TILE 10-19: Digits 0-9
    // 0
    0x3C, 0x3C, 0x66, 0x66, 0x6E, 0x6E, 0x76, 0x76,
    0x66, 0x66, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // 1
    0x18, 0x18, 0x38, 0x38, 0x18, 0x18, 0x18, 0x18,
    0x18, 0x18, 0x18, 0x18, 0x7E, 0x7E, 0x00, 0x00,
    // 2
    0x3C, 0x3C, 0x66, 0x66, 0x06, 0x06, 0x1C, 0x1C,
    0x30, 0x30, 0x60, 0x60, 0x7E, 0x7E, 0x00, 0x00,
    // 3
    0x3C, 0x3C, 0x66, 0x66, 0x06, 0x06, 0x1C, 0x1C,
    0x06, 0x06, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // 4
    0x0C, 0x0C, 0x1C, 0x1C, 0x3C, 0x3C, 0x6C, 0x6C,
    0x7E, 0x7E, 0x0C, 0x0C, 0x0C, 0x0C, 0x00, 0x00,
    // 5
    0x7E, 0x7E, 0x60, 0x60, 0x7C, 0x7C, 0x06, 0x06,
    0x06, 0x06, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // 6
    0x1C, 0x1C, 0x30, 0x30, 0x60, 0x60, 0x7C, 0x7C,
    0x66, 0x66, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // 7
    0x7E, 0x7E, 0x06, 0x06, 0x0C, 0x0C, 0x18, 0x18,
    0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00,
    // 8
    0x3C, 0x3C, 0x66, 0x66, 0x66, 0x66, 0x3C, 0x3C,
    0x66, 0x66, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // 9
    0x3C, 0x3C, 0x66, 0x66, 0x66, 0x66, 0x3E, 0x3E,
    0x06, 0x06, 0x0C, 0x0C, 0x38, 0x38, 0x00, 0x00,
    
    // TILE 20: S
    0x3C, 0x3C, 0x66, 0x66, 0x60, 0x60, 0x3C, 0x3C,
    0x06, 0x06, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // TILE 21: C
    0x3C, 0x3C, 0x66, 0x66, 0x60, 0x60, 0x60, 0x60,
    0x60, 0x60, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // TILE 22: O
    0x3C, 0x3C, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66,
    0x66, 0x66, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // TILE 23: R
    0x7C, 0x7C, 0x66, 0x66, 0x66, 0x66, 0x7C, 0x7C,
    0x6C, 0x6C, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00,
    // TILE 24: E
    0x7E, 0x7E, 0x60, 0x60, 0x60, 0x60, 0x7C, 0x7C,
    0x60, 0x60, 0x60, 0x60, 0x7E, 0x7E, 0x00, 0x00,
    // TILE 25: G
    0x3C, 0x3C, 0x66, 0x66, 0x60, 0x60, 0x6E, 0x6E,
    0x66, 0x66, 0x66, 0x66, 0x3C, 0x3C, 0x00, 0x00,
    // TILE 26: A
    0x18, 0x18, 0x3C, 0x3C, 0x66, 0x66, 0x66, 0x66,
    0x7E, 0x7E, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00,
    // TILE 27: M
    0x63, 0x63, 0x77, 0x77, 0x7F, 0x7F, 0x6B, 0x6B,
    0x63, 0x63, 0x63, 0x63, 0x63, 0x63, 0x00, 0x00,
    // TILE 28: V
    0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66,
    0x66, 0x66, 0x3C, 0x3C, 0x18, 0x18, 0x00, 0x00,
    // TILE 29: W
    0x63, 0x63, 0x63, 0x63, 0x63, 0x63, 0x6B, 0x6B,
    0x7F, 0x7F, 0x77, 0x77, 0x63, 0x63, 0x00, 0x00,
    // TILE 30: T
    0x7E, 0x7E, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
    0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00,
    // TILE 31: H
    0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x7E, 0x7E,
    0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00,
    // TILE 32: P
    0x7C, 0x7C, 0x66, 0x66, 0x66, 0x66, 0x7C, 0x7C,
    0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x00, 0x00,
    // TILE 33: L
    0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60,
    0x60, 0x60, 0x60, 0x60, 0x7E, 0x7E, 0x00, 0x00,
    // TILE 34: Y
    0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x3C, 0x3C,
    0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00,
    // TILE 35: I
    0x3C, 0x3C, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
    0x18, 0x18, 0x18, 0x18, 0x3C, 0x3C, 0x00, 0x00,
    // TILE 36: N
    0x66, 0x66, 0x76, 0x76, 0x7E, 0x7E, 0x7E, 0x7E,
    0x6E, 0x6E, 0x66, 0x66, 0x66, 0x66, 0x00, 0x00
};

// ===========================================
// SOUND FUNCTIONS
// ===========================================

void play_tone(uint8_t button) {
    uint16_t freq;
    
    // Select frequency based on button
    switch (button) {
        case BTN_UP:    freq = FREQ_UP; break;
        case BTN_RIGHT: freq = FREQ_RIGHT; break;
        case BTN_DOWN:  freq = FREQ_DOWN; break;
        case BTN_LEFT:  freq = FREQ_LEFT; break;
        default:        freq = FREQ_UP; break;
    }
    
    // Enable sound
    NR52_REG = 0x80;    // Sound on
    NR50_REG = 0x77;    // Volume max both channels
    NR51_REG = 0x11;    // Channel 1 to both outputs
    
    // Channel 1 - Pulse wave
    NR10_REG = 0x00;    // No sweep
    NR11_REG = 0x80;    // 50% duty, no length
    NR12_REG = 0xF0;    // Volume 15, no envelope
    NR13_REG = freq & 0xFF;         // Frequency low
    NR14_REG = 0x80 | ((freq >> 8) & 0x07);  // Trigger, frequency high
}

void stop_tone(void) {
    NR12_REG = 0x00;    // Volume 0
    NR14_REG = 0x00;    // Stop
}

// ===========================================
// INITIALIZATION
// ===========================================

void sprites_init(void) {
    // Load background tiles
    set_bkg_data(0, 10, button_tiles);
    set_bkg_data(10, 27, hud_tiles);
    
    // Enable sound
    NR52_REG = 0x80;
}
